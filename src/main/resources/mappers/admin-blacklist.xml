<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sdtalk.admin.blacklist">
	
	<!-- 관심고객 목록 조회 -->
	<select id="selectAll" parameterType="map" resultType="map">
		select * 
		from Customer a
		where a.cid = #{cid}
		and a.blocktype > 0
		<if test='keyfield != null and keyfield != "" and keyword != null and keyword != ""'>
			<choose>
				<when test='keyfield == "name"'>
					and name like concat('%', #{keyword}, '%') 
				</when>
				<when test='keyfield == "telno"'>
					and telno like concat('%', #{keyword}, '%')
				</when>
				<when test='keyfield == "blocktype"'>
					and blocktype = #{keyword}
				</when>
				<when test='keyfield == "remark"'>
					and remark like concat('%', #{keyword}, '%')
				</when>
				<when test='keyfield == "emp"'>
					and blockemp = #{keyword}
				</when>
			</choose>
		</if>
	</select>
	
	<!-- 관심고객 정보 등록/해제 -->
	<update id="update" parameterType="map">
		update Customer 
		set blocktype = #{type},  
			blockdt = now(), 
			blockemp = #{emp},
			remark = #{msg}
 		where userno = #{userno}
 	</update>
</mapper>